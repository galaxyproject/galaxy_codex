{% load markdown %}

<section class="my-5">
  {% if help_links %}
  <h4 class="mb-3">Single Cell and Spatial Omics community support</h4>
  <ul>
    {% for link in help_links %}
    <li>
      <a href="{{ link.url }}" target="_blank">{{ link.title }}</a>
    </li>
    {% endfor %}
  </ul>
  {% endif %}
</section>

<section>
  <h4 class="mb-3">News and Events</h4>

  <div class="row justify-content-center" id="newsAndEvents">
    <div class="col">
      <iframe width="400px" height="600px" src="https://training.galaxyproject.org/training-material/topics/single-cell/feed.w.xml"></iframe>
    </div>
    <div class="col">
      <iframe width="400px" height="600px" src="https://training.galaxyproject.org/training-material/feeds/single-cell-month.w.xml"></iframe>
    </div>
  </div>

  <script>
    // Function to detect Safari on Mac
    function isSafari() {
        return /^((?!chrome|android).)*safari/i.test(navigator.userAgent) && /Mac/i.test(navigator.platform);
    }

    // Replace iframe with error text if on Safari
    if (isSafari()) {
        const newsDiv = $('#newsAndEvents');
        if (newsDiv.length) {
            const errorText = $(`<p class="alert alert-danger">
              Sorry, this content cannot be displayed in Safari. Please use a different browser to see news and events feed, or add the
              <a href="https://training.galaxyproject.org/training-material/topics/single-cell/feed.xml">RSS feed</a>
              to your RSS reader.
            </p>`);
            newsDiv.children().remove();
            newsDiv.append(errorText);
        }
    }
  </script>
</section>

{% if feedback_email %}
<section class="my-5">
  <h4 class="my-3">What do you think of the {{ lab_name }}?</h4>
  <button
    class="ga-btn"
    data-bs-toggle="modal"
    data-bs-target="#feedbackModal"
  >
    Give feedback
  </button>
</section>
{% endif %}


<section id="conclusionExtra">
  {{ conclusion_extra_md|safe }}
</section>
